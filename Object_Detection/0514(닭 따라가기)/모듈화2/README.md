# 닭 객체 추적 시스템

## 프로젝트 개요
이 프로젝트는 딥러닝 기반의 닭 객체 추적 시스템으로, 영상에서 닭을 감지하고 지속적으로 추적하는 기능을 제공합니다. 화면을 그리드로 분할하여 특정 영역을 확대해서 볼 수 있고, 각 닭의 ID를 일관되게 유지하는 알고리즘을 구현했습니다.

## 구성 요소

### 1. main.py
메인 실행 파일로 비디오 플레이어를 초기화하고 실행합니다.
- 비디오 경로와 모델 경로를 설정
- 3x3 그리드와 0.5 배율로 VideoPlayer 객체 생성 및 실행

### 2. VideoPlayer.py
비디오 재생 및 그리드 분할, 사용자 인터랙션을 담당합니다.
- 그리드 분할 시각화 (3x3 그리드)
- 키보드 단축키로 다양한 기능 제어 (재생/일시정지, 그리드/확대 모드 전환 등)
- 마우스 클릭으로 특정 그리드 셀 선택 및 확대
- 객체 추적 ID 시각화 개선 (배경 추가, ID 세트 명확하게 표시)
- 상태 정보 표시 (배율, 시간, 탐지된 닭 수, 모드 등)

주요 헬퍼 메서드:
- `_get_id_set_for_detection()`: 객체의 ID 세트를 일관성 있게 가져오는 함수
- `_draw_id_text_with_background()`: ID 텍스트를 배경과 함께 그리는 함수

### 3. ChickenDetector.py
YOLO 모델을 사용하여 닭을 감지하고 추적하는 알고리즘을 구현합니다.
- YOLO 모델을 사용한 닭 객체 탐지
- 객체 추적 알고리즘으로 ID 일관성 유지
- 객체가 잠시 사라졌다가 다시 나타나도 같은 ID로 식별

개선된 객체 추적 알고리즘:
- 거리 임계값을 50px에서 25px로 줄여 정확성 향상
- 시간 임계값을 2.0초에서 1.5초로 줄여 시간 정밀도 향상
- 최적 매칭 알고리즘으로 ID 중복 할당 방지
- 이미 매칭된 ID 추적으로 중복 매칭 방지
- ID 세트를 사용하여 동일 객체로 식별된 ID들을 그룹화

### 4. TextRenderer.py
한글 텍스트를 이미지에 렌더링하는 기능을 제공합니다.
- PIL 라이브러리를 사용한 한글 텍스트 렌더링
- 배경이 있는 텍스트 표시 옵션
- 다양한 PIL 버전에 대한 호환성 지원

## 사용 방법
1. main.py 실행
2. 키보드 단축키:
   - 'q': 종료
   - 'g': 그리드 모드/확대 모드 전환
   - '+/-': 확대/축소
   - 'y': YOLO 탐지 켜기/끄기
   - 't': 객체 추적(ID 표시) 켜기/끄기
   - 'c': 일관된 ID 추적 켜기/끄기
   - '[/]': 탐지 임계값 조절
   - '1'/'2': 탐지 간격 감소/증가
   - 스페이스바: 재생/일시정지
   - 'a'/'d': 뒤로/앞으로 5초
3. 마우스로 그리드 칸을 클릭하여 해당 영역 확대

## 개선사항
- 거리 임계값 최적화 (50px → 25px)
- 시간 임계값 최적화 (2.0초 → 1.5초)  
- 객체 ID 시각화 개선 (배경 추가, 정렬된 ID 세트)
- 그리드 크기 최적화 (5x5 → 3x3)
- ID 매칭 알고리즘 개선으로 객체 식별 정확도 향상

## 버그 수정
- ChickenDetector 클래스의 `use_consistent_ids` 속성 초기화 문제 수정
  - 줄 바꿈 문제로 인해 속성이 제대로 초기화되지 않아 오류가 발생하던 문제 해결
